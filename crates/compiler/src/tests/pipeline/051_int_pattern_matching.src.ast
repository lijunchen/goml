struct PairData {
    head: int32,
    tail: int64,
}

fn is_special8(value: int8) -> bool {
    match value {
        5 => true,
        7 => true,
        _ => false,
    }
}

fn is_special16(value: int16) -> bool {
    match value {
        1024 => true,
        2048 => true,
        _ => false,
    }
}

fn is_special32(value: int32) -> bool {
    match value {
        4096 => true,
        8192 => true,
        _ => false,
    }
}

fn is_special64(value: int64) -> bool {
    match value {
        16384 => true,
        32768 => true,
        _ => false,
    }
}

fn match_tuple(values: (int8, int16)) -> bool {
    match values {
        (1, 2) => true,
        _ => false,
    }
}

fn match_struct(pair: PairData) -> bool {
    match pair {
        PairData { head: 100, tail: 200 } => true,
        PairData { head: _, tail: 300 } => true,
        _ => false,
    }
}

fn report(label: string, value: bool) -> string {
    label + bool_to_string(value)
}

fn main() {
    let tuple_first: int8 = 1 in
    let tuple_second: int16 = 2 in
    let tuple_result_hit = match_tuple((tuple_first, tuple_second)) in
    let tuple_result_miss = match_tuple((3, 4)) in
    let pair_first = match_struct(PairData {
          head: 100,
          tail: 200
      }) in
    let pair_second = match_struct(PairData {
          head: 10,
          tail: 300
      }) in
    let part1 = report("int8=", is_special8(5)) in
    let part2 = report(",int16=", is_special16(1024)) in
    let part3 = report(",int32=", is_special32(8192)) in
    let part4 = report(",int64_a=", is_special64(16384)) in
    let part5 = report(",int64_b=", is_special64(32768)) in
    let part6 = report(",tuple_hit=", tuple_result_hit) in
    let part7 = report(",tuple_miss=", tuple_result_miss) in
    let part8 = report(",struct_first=", pair_first) in
    let part9 = report(",struct_second=", pair_second) in
    let message = part1 + part2 + part3 + part4 + part5 + part6 + part7 + part8 + part9 in
    let _ = string_println(message) in
    ()
}

