fn test() {
    let y = 3 in
    let z = 5 in
    let f = |x: int| x * y * z in
    let _ = string_println(int_to_string(f(2))) in
    string_println(int_to_string(f(3)))
}

fn call_int_id(f : (int) -> int, v: int) -> int {
    f(v)
}

enum IntList {
    Nil,
    Cons(int, IntList),
}

struct Point {
    x: int,
    y: int,
}

fn main() {
    let base = 5 in
    let add_base = |x: int| x + base in
    let result = add_base(7) in
    let printer = |prefix: string, value: int| {
        let message = string_add(prefix, int_to_string(value)) in
        string_println(message)
    } in
    let _ = printer("result: ", result) in
    let unused = |y: int| y + result in
    let no_capture = |z: int| z * 2 in
    let doubled = no_capture(3) in
    let _ = string_println(int_to_string(doubled)) in
    let _ = test() in

    let list123 = Cons(1, Cons(2, Cons(3, Nil))) in

    let point = Point { x: 10, y: 20 } in

    let play_list_and_point = || {
        match list123 {
            Nil => string_println("Empty list"),
            Cons(head, tail) => {
                let _ = string_println(int_to_string(head)) in
                match point {
                    Point { x: x, y: y } => {
                        let _ = string_println(string_add("Point: (", string_add(int_to_string(x), string_add(", ", string_add(int_to_string(y), ")"))))) in
                        ()
                    }
                }
            }
        }
    } in

    let _ = play_list_and_point() in
    ()
}
